"use strict";(self.webpackChunkdog_sitter_react=self.webpackChunkdog_sitter_react||[]).push([[7133],{7133:function(e,t,r){r.r(t),r.d(t,{Camera:function(){return f},CameraWeb:function(){return l}});var n=r(4165),a=r(5861),i=r(5671),o=r(3144),c=r(136),u=r(7277),s=r(6653),p=r(2012),l=function(e){(0,c.Z)(r,e);var t=(0,u.Z)(r);function r(){return(0,i.Z)(this,r),t.apply(this,arguments)}return(0,o.Z)(r,[{key:"getPhoto",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,a.Z)((0,n.Z)().mark((function e(i,o){var c;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.webUseInput||t.source===p.oK.Photos?r.fileInputExperience(t,i):t.source===p.oK.Prompt?((c=document.querySelector("pwa-action-sheet"))||(c=document.createElement("pwa-action-sheet"),document.body.appendChild(c)),c.header=t.promptLabelHeader||"Photo",c.cancelable=!1,c.options=[{title:t.promptLabelPhoto||"From Photos"},{title:t.promptLabelPicture||"Take Picture"}],c.addEventListener("onSelection",function(){var e=(0,a.Z)((0,n.Z)().mark((function e(a){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0===a.detail?r.fileInputExperience(t,i):r.cameraExperience(t,i,o);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):r.cameraExperience(t,i,o);case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"pickImages",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){var r=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.multipleFileInputExperience(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"cameraExperience",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(t,r,i){var o,c=this;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!customElements.get("pwa-camera-modal")){e.next=16;break}return(o=document.createElement("pwa-camera-modal")).facingMode=t.direction===p.GW.Front?"user":"environment",document.body.appendChild(o),e.prev=4,e.next=7,o.componentOnReady();case 7:o.addEventListener("onPhoto",function(){var e=(0,a.Z)((0,n.Z)().mark((function e(a){var u;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(u=a.detail)){e.next=5;break}i(new s.xz("User cancelled photos app")),e.next=14;break;case 5:if(!(u instanceof Error)){e.next=9;break}i(u),e.next=14;break;case 9:return e.t0=r,e.next=12,c._getCameraPhoto(u,t);case 12:e.t1=e.sent,(0,e.t0)(e.t1);case 14:o.dismiss(),document.body.removeChild(o);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),o.present(),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),this.fileInputExperience(t,r);case 14:e.next=18;break;case 16:console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(t,r);case 18:case"end":return e.stop()}}),e,this,[[4,11]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"fileInputExperience",value:function(e,t){var r=document.querySelector("#_capacitor-camera-input"),n=function(){var e;null===(e=r.parentNode)||void 0===e||e.removeChild(r)};r||((r=document.createElement("input")).id="_capacitor-camera-input",r.type="file",r.hidden=!0,document.body.appendChild(r),r.addEventListener("change",(function(a){var i=r.files[0],o="jpeg";if("image/png"===i.type?o="png":"image/gif"===i.type&&(o="gif"),"dataUrl"===e.resultType||"base64"===e.resultType){var c=new FileReader;c.addEventListener("load",(function(){if("dataUrl"===e.resultType)t({dataUrl:c.result,format:o});else if("base64"===e.resultType){var r=c.result.split(",")[1];t({base64String:r,format:o})}n()})),c.readAsDataURL(i)}else t({webPath:URL.createObjectURL(i),format:o}),n()}))),r.accept="image/*",r.capture=!0,e.source===p.oK.Photos||e.source===p.oK.Prompt?r.removeAttribute("capture"):e.direction===p.GW.Front?r.capture="user":e.direction===p.GW.Rear&&(r.capture="environment"),r.click()}},{key:"multipleFileInputExperience",value:function(e){var t=document.querySelector("#_capacitor-camera-input-multiple");t||((t=document.createElement("input")).id="_capacitor-camera-input-multiple",t.type="file",t.hidden=!0,t.multiple=!0,document.body.appendChild(t),t.addEventListener("change",(function(r){for(var n=[],a=0;a<t.files.length;a++){var i=t.files[a],o="jpeg";"image/png"===i.type?o="png":"image/gif"===i.type&&(o="gif"),n.push({webPath:URL.createObjectURL(i),format:o})}e({photos:n}),function(){var e;null===(e=t.parentNode)||void 0===e||e.removeChild(t)}()}))),t.accept="image/*",t.click()}},{key:"_getCameraPhoto",value:function(e,t){return new Promise((function(r,n){var a=new FileReader,i=e.type.split("/")[1];"uri"===t.resultType?r({webPath:URL.createObjectURL(e),format:i,saved:!1}):(a.readAsDataURL(e),a.onloadend=function(){var e=a.result;"dataUrl"===t.resultType?r({dataUrl:e,format:i,saved:!1}):r({base64String:e.split(",")[1],format:i,saved:!1})},a.onerror=function(e){n(e)})}))}},{key:"checkPermissions",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){var t;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof navigator&&navigator.permissions){e.next=2;break}throw this.unavailable("Permissions API not available in this browser");case 2:return e.prev=2,e.next=5,window.navigator.permissions.query({name:"camera"});case 5:return t=e.sent,e.abrupt("return",{camera:t.state,photos:"granted"});case 9:throw e.prev=9,e.t0=e.catch(2),this.unavailable("Camera permissions are not available in this browser");case 12:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"requestPermissions",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw this.unimplemented("Not implemented on web.");case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pickLimitedLibraryPhotos",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw this.unavailable("Not implemented on web.");case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getLimitedLibraryPhotos",value:function(){var e=(0,a.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw this.unavailable("Not implemented on web.");case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(s.Uw),f=new l}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdGljL2pzLzcxMzMuZjYzOGJkMGQuY2h1bmsuanMiLCJtYXBwaW5ncyI6IndSQVlhQSxFQUFVLFNBQUFDLElBQUFDLEVBQUFBLEVBQUFBLEdBQUFGLEVBQUFDLEdBQUEsSUFBQUUsR0FBQUMsRUFBQUEsRUFBQUEsR0FBQUosR0FBQSxTQUFBQSxJQUFBLE9BQUFLLEVBQUFBLEVBQUFBLEdBQUEsS0FBQUwsR0FBQUcsRUFBQUcsTUFBQSxLQUFBQyxVQUFBLENBeVFwQixPQXpRb0JDLEVBQUFBLEVBQUFBLEdBQUFSLEVBQUEsRUFBQVMsSUFBQSxXQUFBQyxNQUFBLGVBQUFDLEdBQUFDLEVBQUFBLEVBQUFBLElBQUFDLEVBQUFBLEVBQUFBLEtBQUFDLE1BQ3JCLFNBQUFDLEVBQWVDLEdBQXFCLElBQUFDLEVBQUEsWUFBQUosRUFBQUEsRUFBQUEsS0FBQUssTUFBQSxTQUFBQyxHQUFBLGNBQUFBLEVBQUFDLEtBQUFELEVBQUFFLE1BQUEsY0FBQUYsRUFBQUcsT0FBQSxTQUUzQixJQUFJQyxRQUFPLGVBQUFDLEdBQUFaLEVBQUFBLEVBQUFBLElBQUFDLEVBQUFBLEVBQUFBLEtBQUFDLE1BQVEsU0FBQVcsRUFBT0MsRUFBU0MsR0FBTSxJQUFBQyxFQUFBLE9BQUFmLEVBQUFBLEVBQUFBLEtBQUFLLE1BQUEsU0FBQVcsR0FBQSxjQUFBQSxFQUFBVCxLQUFBUyxFQUFBUixNQUFBLE9BQzFDTCxFQUFRYyxhQUFlZCxFQUFRZSxTQUFXQyxFQUFBQSxHQUFhQyxPQUN6RGhCLEVBQUtpQixvQkFBb0JsQixFQUFTVSxHQUN6QlYsRUFBUWUsU0FBV0MsRUFBQUEsR0FBYUcsU0FDckNQLEVBQW1CUSxTQUFTQyxjQUFjLHVCQUU1Q1QsRUFBY1EsU0FBU0UsY0FBYyxvQkFDckNGLFNBQVNHLEtBQUtDLFlBQVlaLElBRTVCQSxFQUFZYSxPQUFTekIsRUFBUTBCLG1CQUFxQixRQUNsRGQsRUFBWWUsWUFBYSxFQUN6QmYsRUFBWVosUUFBVSxDQUNwQixDQUFFNEIsTUFBTzVCLEVBQVE2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RyxPQUFBLEdBQUFrRyxFQUFBLFVBQ3BELHlCQUFBRCxFQUFBakosTUFBQSxLQUFBQyxVQUFBLEVBSkEsSUFJQSxDQUFBRSxJQUFBLDJCQUFBQyxNQUFBLGVBQUFpSixHQUFBL0ksRUFBQUEsRUFBQUEsSUFBQUMsRUFBQUEsRUFBQUEsS0FBQUMsTUFFRCxTQUFBOEksSUFBQSxPQUFBL0ksRUFBQUEsRUFBQUEsS0FBQUssTUFBQSxTQUFBMkksR0FBQSxjQUFBQSxFQUFBekksS0FBQXlJLEVBQUF4SSxNQUFBLGFBQ1EyRSxLQUFLaUQsWUFBWSwyQkFBMEIsd0JBQUFZLEVBQUF2RyxPQUFBLEdBQUFzRyxFQUFBLFVBQ2xELHlCQUFBRCxFQUFBckosTUFBQSxLQUFBQyxVQUFBLEVBSkEsSUFJQSxDQUFBRSxJQUFBLDBCQUFBQyxNQUFBLGVBQUFvSixHQUFBbEosRUFBQUEsRUFBQUEsSUFBQUMsRUFBQUEsRUFBQUEsS0FBQUMsTUFFRCxTQUFBaUosSUFBQSxPQUFBbEosRUFBQUEsRUFBQUEsS0FBQUssTUFBQSxTQUFBOEksR0FBQSxjQUFBQSxFQUFBNUksS0FBQTRJLEVBQUEzSSxNQUFBLGFBQ1EyRSxLQUFLaUQsWUFBWSwyQkFBMEIsd0JBQUFlLEVBQUExRyxPQUFBLEdBQUF5RyxFQUFBLFVBQ2xELHlCQUFBRCxFQUFBeEosTUFBQSxLQUFBQyxVQUFBLEVBSkEsTUFJQVAsQ0FBQSxDQXpRb0IsQ0FBUWlLLEVBQUFBLElBNFF6QkMsRUFBUyxJQUFJbEssQyIsInNvdXJjZXMiOlsiLi4vbm9kZV9tb2R1bGVzL0BjYXBhY2l0b3IvY2FtZXJhL3NyYy93ZWIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgV2ViUGx1Z2luLCBDYXBhY2l0b3JFeGNlcHRpb24gfSBmcm9tICdAY2FwYWNpdG9yL2NvcmUnO1xuXG5pbXBvcnQgeyBDYW1lcmFTb3VyY2UsIENhbWVyYURpcmVjdGlvbiB9IGZyb20gJy4vZGVmaW5pdGlvbnMnO1xuaW1wb3J0IHR5cGUge1xuICBDYW1lcmFQbHVnaW4sXG4gIEdhbGxlcnlJbWFnZU9wdGlvbnMsXG4gIEdhbGxlcnlQaG90b3MsXG4gIEltYWdlT3B0aW9ucyxcbiAgUGVybWlzc2lvblN0YXR1cyxcbiAgUGhvdG8sXG59IGZyb20gJy4vZGVmaW5pdGlvbnMnO1xuXG5leHBvcnQgY2xhc3MgQ2FtZXJhV2ViIGV4dGVuZHMgV2ViUGx1Z2luIGltcGxlbWVudHMgQ2FtZXJhUGx1Z2luIHtcbiAgYXN5bmMgZ2V0UGhvdG8ob3B0aW9uczogSW1hZ2VPcHRpb25zKTogUHJvbWlzZTxQaG90bz4ge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1hc3luYy1wcm9taXNlLWV4ZWN1dG9yXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlPFBob3RvPihhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAob3B0aW9ucy53ZWJVc2VJbnB1dCB8fCBvcHRpb25zLnNvdXJjZSA9PT0gQ2FtZXJhU291cmNlLlBob3Rvcykge1xuICAgICAgICB0aGlzLmZpbGVJbnB1dEV4cGVyaWVuY2Uob3B0aW9ucywgcmVzb2x2ZSk7XG4gICAgICB9IGVsc2UgaWYgKG9wdGlvbnMuc291cmNlID09PSBDYW1lcmFTb3VyY2UuUHJvbXB0KSB7XG4gICAgICAgIGxldCBhY3Rpb25TaGVldDogYW55ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigncHdhLWFjdGlvbi1zaGVldCcpO1xuICAgICAgICBpZiAoIWFjdGlvblNoZWV0KSB7XG4gICAgICAgICAgYWN0aW9uU2hlZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwd2EtYWN0aW9uLXNoZWV0Jyk7XG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhY3Rpb25TaGVldCk7XG4gICAgICAgIH1cbiAgICAgICAgYWN0aW9uU2hlZXQuaGVhZGVyID0gb3B0aW9ucy5wcm9tcHRMYWJlbEhlYWRlciB8fCAnUGhvdG8nO1xuICAgICAgICBhY3Rpb25TaGVldC5jYW5jZWxhYmxlID0gZmFsc2U7XG4gICAgICAgIGFjdGlvblNoZWV0Lm9wdGlvbnMgPSBbXG4gICAgICAgICAgeyB0aXRsZTogb3B0aW9ucy5wcm9tcHRMYWJlbFBob3RvIHx8ICdGcm9tIFBob3RvcycgfSxcbiAgICAgICAgICB7IHRpdGxlOiBvcHRpb25zLnByb21wdExhYmVsUGljdHVyZSB8fCAnVGFrZSBQaWN0dXJlJyB9LFxuICAgICAgICBdO1xuICAgICAgICBhY3Rpb25TaGVldC5hZGRFdmVudExpc3RlbmVyKCdvblNlbGVjdGlvbicsIGFzeW5jIChlOiBhbnkpID0+IHtcbiAgICAgICAgICBjb25zdCBzZWxlY3Rpb24gPSBlLmRldGFpbDtcbiAgICAgICAgICBpZiAoc2VsZWN0aW9uID09PSAwKSB7XG4gICAgICAgICAgICB0aGlzLmZpbGVJbnB1dEV4cGVyaWVuY2Uob3B0aW9ucywgcmVzb2x2ZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2FtZXJhRXhwZXJpZW5jZShvcHRpb25zLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNhbWVyYUV4cGVyaWVuY2Uob3B0aW9ucywgcmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHBpY2tJbWFnZXMoX29wdGlvbnM6IEdhbGxlcnlJbWFnZU9wdGlvbnMpOiBQcm9taXNlPEdhbGxlcnlQaG90b3M+IHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYXN5bmMtcHJvbWlzZS1leGVjdXRvclxuICAgIHJldHVybiBuZXcgUHJvbWlzZTxHYWxsZXJ5UGhvdG9zPihhc3luYyByZXNvbHZlID0+IHtcbiAgICAgIHRoaXMubXVsdGlwbGVGaWxlSW5wdXRFeHBlcmllbmNlKHJlc29sdmUpO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjYW1lcmFFeHBlcmllbmNlKFxuICAgIG9wdGlvbnM6IEltYWdlT3B0aW9ucyxcbiAgICByZXNvbHZlOiBhbnksXG4gICAgcmVqZWN0OiBhbnksXG4gICkge1xuICAgIGlmIChjdXN0b21FbGVtZW50cy5nZXQoJ3B3YS1jYW1lcmEtbW9kYWwnKSkge1xuICAgICAgY29uc3QgY2FtZXJhTW9kYWw6IGFueSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3B3YS1jYW1lcmEtbW9kYWwnKTtcbiAgICAgIGNhbWVyYU1vZGFsLmZhY2luZ01vZGUgPVxuICAgICAgICBvcHRpb25zLmRpcmVjdGlvbiA9PT0gQ2FtZXJhRGlyZWN0aW9uLkZyb250ID8gJ3VzZXInIDogJ2Vudmlyb25tZW50JztcbiAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2FtZXJhTW9kYWwpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgY2FtZXJhTW9kYWwuY29tcG9uZW50T25SZWFkeSgpO1xuICAgICAgICBjYW1lcmFNb2RhbC5hZGRFdmVudExpc3RlbmVyKCdvblBob3RvJywgYXN5bmMgKGU6IGFueSkgPT4ge1xuICAgICAgICAgIGNvbnN0IHBob3RvID0gZS5kZXRhaWw7XG5cbiAgICAgICAgICBpZiAocGhvdG8gPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgQ2FwYWNpdG9yRXhjZXB0aW9uKCdVc2VyIGNhbmNlbGxlZCBwaG90b3MgYXBwJykpO1xuICAgICAgICAgIH0gZWxzZSBpZiAocGhvdG8gaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICAgICAgcmVqZWN0KHBob3RvKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZShhd2FpdCB0aGlzLl9nZXRDYW1lcmFQaG90byhwaG90bywgb3B0aW9ucykpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNhbWVyYU1vZGFsLmRpc21pc3MoKTtcbiAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGNhbWVyYU1vZGFsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY2FtZXJhTW9kYWwucHJlc2VudCgpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aGlzLmZpbGVJbnB1dEV4cGVyaWVuY2Uob3B0aW9ucywgcmVzb2x2ZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgIGBVbmFibGUgdG8gbG9hZCBQV0EgRWxlbWVudCAncHdhLWNhbWVyYS1tb2RhbCcuIFNlZSB0aGUgZG9jczogaHR0cHM6Ly9jYXBhY2l0b3Jqcy5jb20vZG9jcy93ZWIvcHdhLWVsZW1lbnRzLmAsXG4gICAgICApO1xuICAgICAgdGhpcy5maWxlSW5wdXRFeHBlcmllbmNlKG9wdGlvbnMsIHJlc29sdmUpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZmlsZUlucHV0RXhwZXJpZW5jZShvcHRpb25zOiBJbWFnZU9wdGlvbnMsIHJlc29sdmU6IGFueSkge1xuICAgIGxldCBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAnI19jYXBhY2l0b3ItY2FtZXJhLWlucHV0JyxcbiAgICApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICBjb25zdCBjbGVhbnVwID0gKCkgPT4ge1xuICAgICAgaW5wdXQucGFyZW50Tm9kZT8ucmVtb3ZlQ2hpbGQoaW5wdXQpO1xuICAgIH07XG5cbiAgICBpZiAoIWlucHV0KSB7XG4gICAgICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgIGlucHV0LmlkID0gJ19jYXBhY2l0b3ItY2FtZXJhLWlucHV0JztcbiAgICAgIGlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgICBpbnB1dC5oaWRkZW4gPSB0cnVlO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpbnB1dCk7XG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoX2U6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCBmaWxlID0gaW5wdXQuZmlsZXMhWzBdO1xuICAgICAgICBsZXQgZm9ybWF0ID0gJ2pwZWcnO1xuXG4gICAgICAgIGlmIChmaWxlLnR5cGUgPT09ICdpbWFnZS9wbmcnKSB7XG4gICAgICAgICAgZm9ybWF0ID0gJ3BuZyc7XG4gICAgICAgIH0gZWxzZSBpZiAoZmlsZS50eXBlID09PSAnaW1hZ2UvZ2lmJykge1xuICAgICAgICAgIGZvcm1hdCA9ICdnaWYnO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKFxuICAgICAgICAgIG9wdGlvbnMucmVzdWx0VHlwZSA9PT0gJ2RhdGFVcmwnIHx8XG4gICAgICAgICAgb3B0aW9ucy5yZXN1bHRUeXBlID09PSAnYmFzZTY0J1xuICAgICAgICApIHtcbiAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgICAgICAgcmVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgICAgICAgICBpZiAob3B0aW9ucy5yZXN1bHRUeXBlID09PSAnZGF0YVVybCcpIHtcbiAgICAgICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgZGF0YVVybDogcmVhZGVyLnJlc3VsdCxcbiAgICAgICAgICAgICAgICBmb3JtYXQsXG4gICAgICAgICAgICAgIH0gYXMgUGhvdG8pO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLnJlc3VsdFR5cGUgPT09ICdiYXNlNjQnKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGI2NCA9IChyZWFkZXIucmVzdWx0IGFzIHN0cmluZykuc3BsaXQoJywnKVsxXTtcbiAgICAgICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICAgICAgYmFzZTY0U3RyaW5nOiBiNjQsXG4gICAgICAgICAgICAgICAgZm9ybWF0LFxuICAgICAgICAgICAgICB9IGFzIFBob3RvKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoZmlsZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICB3ZWJQYXRoOiBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpLFxuICAgICAgICAgICAgZm9ybWF0OiBmb3JtYXQsXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY2xlYW51cCgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpbnB1dC5hY2NlcHQgPSAnaW1hZ2UvKic7XG4gICAgKGlucHV0IGFzIGFueSkuY2FwdHVyZSA9IHRydWU7XG5cbiAgICBpZiAoXG4gICAgICBvcHRpb25zLnNvdXJjZSA9PT0gQ2FtZXJhU291cmNlLlBob3RvcyB8fFxuICAgICAgb3B0aW9ucy5zb3VyY2UgPT09IENhbWVyYVNvdXJjZS5Qcm9tcHRcbiAgICApIHtcbiAgICAgIGlucHV0LnJlbW92ZUF0dHJpYnV0ZSgnY2FwdHVyZScpO1xuICAgIH0gZWxzZSBpZiAob3B0aW9ucy5kaXJlY3Rpb24gPT09IENhbWVyYURpcmVjdGlvbi5Gcm9udCkge1xuICAgICAgKGlucHV0IGFzIGFueSkuY2FwdHVyZSA9ICd1c2VyJztcbiAgICB9IGVsc2UgaWYgKG9wdGlvbnMuZGlyZWN0aW9uID09PSBDYW1lcmFEaXJlY3Rpb24uUmVhcikge1xuICAgICAgKGlucHV0IGFzIGFueSkuY2FwdHVyZSA9ICdlbnZpcm9ubWVudCc7XG4gICAgfVxuXG4gICAgaW5wdXQuY2xpY2soKTtcbiAgfVxuXG4gIHByaXZhdGUgbXVsdGlwbGVGaWxlSW5wdXRFeHBlcmllbmNlKHJlc29sdmU6IGFueSkge1xuICAgIGxldCBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAnI19jYXBhY2l0b3ItY2FtZXJhLWlucHV0LW11bHRpcGxlJyxcbiAgICApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG5cbiAgICBjb25zdCBjbGVhbnVwID0gKCkgPT4ge1xuICAgICAgaW5wdXQucGFyZW50Tm9kZT8ucmVtb3ZlQ2hpbGQoaW5wdXQpO1xuICAgIH07XG5cbiAgICBpZiAoIWlucHV0KSB7XG4gICAgICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgIGlucHV0LmlkID0gJ19jYXBhY2l0b3ItY2FtZXJhLWlucHV0LW11bHRpcGxlJztcbiAgICAgIGlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgICBpbnB1dC5oaWRkZW4gPSB0cnVlO1xuICAgICAgaW5wdXQubXVsdGlwbGUgPSB0cnVlO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpbnB1dCk7XG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoX2U6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCBwaG90b3MgPSBbXTtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9wcmVmZXItZm9yLW9mXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXQuZmlsZXMhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgZmlsZSA9IGlucHV0LmZpbGVzIVtpXTtcbiAgICAgICAgICBsZXQgZm9ybWF0ID0gJ2pwZWcnO1xuXG4gICAgICAgICAgaWYgKGZpbGUudHlwZSA9PT0gJ2ltYWdlL3BuZycpIHtcbiAgICAgICAgICAgIGZvcm1hdCA9ICdwbmcnO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZmlsZS50eXBlID09PSAnaW1hZ2UvZ2lmJykge1xuICAgICAgICAgICAgZm9ybWF0ID0gJ2dpZic7XG4gICAgICAgICAgfVxuICAgICAgICAgIHBob3Rvcy5wdXNoKHtcbiAgICAgICAgICAgIHdlYlBhdGg6IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZSksXG4gICAgICAgICAgICBmb3JtYXQ6IGZvcm1hdCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXNvbHZlKHsgcGhvdG9zIH0pO1xuICAgICAgICBjbGVhbnVwKCk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpbnB1dC5hY2NlcHQgPSAnaW1hZ2UvKic7XG5cbiAgICBpbnB1dC5jbGljaygpO1xuICB9XG5cbiAgcHJpdmF0ZSBfZ2V0Q2FtZXJhUGhvdG8ocGhvdG86IEJsb2IsIG9wdGlvbnM6IEltYWdlT3B0aW9ucykge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZTxQaG90bz4oKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgIGNvbnN0IGZvcm1hdCA9IHBob3RvLnR5cGUuc3BsaXQoJy8nKVsxXTtcbiAgICAgIGlmIChvcHRpb25zLnJlc3VsdFR5cGUgPT09ICd1cmknKSB7XG4gICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgIHdlYlBhdGg6IFVSTC5jcmVhdGVPYmplY3RVUkwocGhvdG8pLFxuICAgICAgICAgIGZvcm1hdDogZm9ybWF0LFxuICAgICAgICAgIHNhdmVkOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChwaG90byk7XG4gICAgICAgIHJlYWRlci5vbmxvYWRlbmQgPSAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgciA9IHJlYWRlci5yZXN1bHQgYXMgc3RyaW5nO1xuICAgICAgICAgIGlmIChvcHRpb25zLnJlc3VsdFR5cGUgPT09ICdkYXRhVXJsJykge1xuICAgICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICAgIGRhdGFVcmw6IHIsXG4gICAgICAgICAgICAgIGZvcm1hdDogZm9ybWF0LFxuICAgICAgICAgICAgICBzYXZlZDogZmFsc2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZSh7XG4gICAgICAgICAgICAgIGJhc2U2NFN0cmluZzogci5zcGxpdCgnLCcpWzFdLFxuICAgICAgICAgICAgICBmb3JtYXQ6IGZvcm1hdCxcbiAgICAgICAgICAgICAgc2F2ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZWFkZXIub25lcnJvciA9IGUgPT4ge1xuICAgICAgICAgIHJlamVjdChlKTtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIGNoZWNrUGVybWlzc2lvbnMoKTogUHJvbWlzZTxQZXJtaXNzaW9uU3RhdHVzPiB7XG4gICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICd1bmRlZmluZWQnIHx8ICFuYXZpZ2F0b3IucGVybWlzc2lvbnMpIHtcbiAgICAgIHRocm93IHRoaXMudW5hdmFpbGFibGUoJ1Blcm1pc3Npb25zIEFQSSBub3QgYXZhaWxhYmxlIGluIHRoaXMgYnJvd3NlcicpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvUGVybWlzc2lvbnMvcXVlcnlcbiAgICAgIC8vIHRoZSBzcGVjaWZpYyBwZXJtaXNzaW9ucyB0aGF0IGFyZSBzdXBwb3J0ZWQgdmFyaWVzIGFtb25nIGJyb3dzZXJzIHRoYXQgaW1wbGVtZW50IHRoZVxuICAgICAgLy8gcGVybWlzc2lvbnMgQVBJLCBzbyB3ZSBuZWVkIGEgdHJ5L2NhdGNoIGluIGNhc2UgJ2NhbWVyYScgaXMgaW52YWxpZFxuICAgICAgY29uc3QgcGVybWlzc2lvbiA9IGF3YWl0IHdpbmRvdy5uYXZpZ2F0b3IucGVybWlzc2lvbnMucXVlcnkoe1xuICAgICAgICBuYW1lOiAnY2FtZXJhJyxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgY2FtZXJhOiBwZXJtaXNzaW9uLnN0YXRlLFxuICAgICAgICBwaG90b3M6ICdncmFudGVkJyxcbiAgICAgIH07XG4gICAgfSBjYXRjaCB7XG4gICAgICB0aHJvdyB0aGlzLnVuYXZhaWxhYmxlKFxuICAgICAgICAnQ2FtZXJhIHBlcm1pc3Npb25zIGFyZSBub3QgYXZhaWxhYmxlIGluIHRoaXMgYnJvd3NlcicsXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHJlcXVlc3RQZXJtaXNzaW9ucygpOiBQcm9taXNlPFBlcm1pc3Npb25TdGF0dXM+IHtcbiAgICB0aHJvdyB0aGlzLnVuaW1wbGVtZW50ZWQoJ05vdCBpbXBsZW1lbnRlZCBvbiB3ZWIuJyk7XG4gIH1cblxuICBhc3luYyBwaWNrTGltaXRlZExpYnJhcnlQaG90b3MoKTogUHJvbWlzZTxHYWxsZXJ5UGhvdG9zPiB7XG4gICAgdGhyb3cgdGhpcy51bmF2YWlsYWJsZSgnTm90IGltcGxlbWVudGVkIG9uIHdlYi4nKTtcbiAgfVxuXG4gIGFzeW5jIGdldExpbWl0ZWRMaWJyYXJ5UGhvdG9zKCk6IFByb21pc2U8R2FsbGVyeVBob3Rvcz4ge1xuICAgIHRocm93IHRoaXMudW5hdmFpbGFibGUoJ05vdCBpbXBsZW1lbnRlZCBvbiB3ZWIuJyk7XG4gIH1cbn1cblxuY29uc3QgQ2FtZXJhID0gbmV3IENhbWVyYVdlYigpO1xuXG5leHBvcnQgeyBDYW1lcmEgfTtcbiJdLCJuYW1lcyI6WyJDYW1lcmFXZWIiLCJfV2ViUGx1Z2luIiwiX2luaGVyaXRzIiwiX3N1cGVyIiwiX2NyZWF0ZVN1cGVyIiwiX2NsYXNzQ2FsbENoZWNrIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJfY3JlYXRlQ2xhc3MiLCJrZXkiLCJ2YWx1ZSIsIl9nZXRQaG90byIsIl9hc3luY1RvR2VuZXJhdG9yIiwiX3JlZ2VuZXJhdG9yUnVudGltZSIsIm1hcmsiLCJfY2FsbGVlMyIsIm9wdGlvbnMiLCJfdGhpcyIsIndyYXAiLCJfY29udGV4dDMiLCJwcmV2IiwibmV4dCIsImFicnVwdCIsIlByb21pc2UiLCJfcmVmIiwiX2NhbGxlZTIiLCJyZXNvbHZlIiwicmVqZWN0IiwiYWN0aW9uU2hlZXQiLCJfY29udGV4dDIiLCJ3ZWJVc2VJbnB1dCIsInNvdXJjZSIsIkNhbWVyYVNvdXJjZSIsIlBob3RvcyIsImZpbGVJbnB1dEV4cGVyaWVuY2UiLCJQcm9tcHQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjcmVhdGVFbGVtZW50IiwiYm9keSIsImFwcGVuZENoaWxkIiwiaGVhZGVyIiwicHJvbXB0TGFiZWxIZWFkZXIiLCJjYW5jZWxhYmxlIiwidGl0bGUiLCJwcm9tcHRMYWJlbFBob3RvIiwicHJvbXB0TGFiZWxQaWN0dXJlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9yZWYyIiwiX2NhbGxlZSIsImUiLCJfY29udGV4dCIsImRldGFpbCIsImNhbWVyYUV4cGVyaWVuY2UiLCJzdG9wIiwiX3g0IiwiX3gyIiwiX3gzIiwiX3giLCJfcGlja0ltYWdlcyIsIl9jYWxsZWU1IiwiX29wdGlvbnMiLCJfdGhpczIiLCJfY29udGV4dDUiLCJfcmVmMyIsIl9jYWxsZWU0IiwiX2NvbnRleHQ0IiwibXVsdGlwbGVGaWxlSW5wdXRFeHBlcmllbmNlIiwiX3g2IiwiX3g1IiwiX2NhbWVyYUV4cGVyaWVuY2UiLCJfY2FsbGVlNyIsImNhbWVyYU1vZGFsIiwiX3RoaXMzIiwiX2NvbnRleHQ3IiwiY3VzdG9tRWxlbWVudHMiLCJnZXQiLCJmYWNpbmdNb2RlIiwiZGlyZWN0aW9uIiwiQ2FtZXJhRGlyZWN0aW9uIiwiRnJvbnQiLCJjb21wb25lbnRPblJlYWR5IiwiX3JlZjQiLCJfY2FsbGVlNiIsInBob3RvIiwiX2NvbnRleHQ2IiwiQ2FwYWNpdG9yRXhjZXB0aW9uIiwiRXJyb3IiLCJ0MCIsIl9nZXRDYW1lcmFQaG90byIsInQxIiwic2VudCIsImRpc21pc3MiLCJyZW1vdmVDaGlsZCIsIl94MTAiLCJwcmVzZW50IiwidGhpcyIsImNvbnNvbGUiLCJlcnJvciIsIl94NyIsIl94OCIsIl94OSIsImlucHV0IiwiY2xlYW51cCIsIl9hIiwicGFyZW50Tm9kZSIsImlkIiwidHlwZSIsImhpZGRlbiIsIl9lIiwiZmlsZSIsImZpbGVzIiwiZm9ybWF0IiwicmVzdWx0VHlwZSIsInJlYWRlciIsIkZpbGVSZWFkZXIiLCJkYXRhVXJsIiwicmVzdWx0IiwiYjY0Iiwic3BsaXQiLCJiYXNlNjRTdHJpbmciLCJyZWFkQXNEYXRhVVJMIiwid2ViUGF0aCIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsImFjY2VwdCIsImNhcHR1cmUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJSZWFyIiwiY2xpY2siLCJtdWx0aXBsZSIsInBob3RvcyIsImkiLCJsZW5ndGgiLCJwdXNoIiwic2F2ZWQiLCJvbmxvYWRlbmQiLCJyIiwib25lcnJvciIsIl9jaGVja1Blcm1pc3Npb25zIiwiX2NhbGxlZTgiLCJwZXJtaXNzaW9uIiwiX2NvbnRleHQ4IiwibmF2aWdhdG9yIiwicGVybWlzc2lvbnMiLCJ1bmF2YWlsYWJsZSIsIndpbmRvdyIsInF1ZXJ5IiwibmFtZSIsImNhbWVyYSIsInN0YXRlIiwiX3JlcXVlc3RQZXJtaXNzaW9ucyIsIl9jYWxsZWU5IiwiX2NvbnRleHQ5IiwidW5pbXBsZW1lbnRlZCIsIl9waWNrTGltaXRlZExpYnJhcnlQaG90b3MiLCJfY2FsbGVlMTAiLCJfY29udGV4dDEwIiwiX2dldExpbWl0ZWRMaWJyYXJ5UGhvdG9zIiwiX2NhbGxlZTExIiwiX2NvbnRleHQxMSIsIldlYlBsdWdpbiIsIkNhbWVyYSJdLCJzb3VyY2VSb290IjoiIn0=